const path=require("path"),express=require("express"),helmet=require("helmet"),bodyParser=require("body-parser"),cors=require("cors"),morgan=require("morgan"),fileStreamRotator=require("file-stream-rotator"),fs=require("fs"),logger=require(path.join(__dirname,"core","Logger.js")),app=express(),port=8080;if(app.use(helmet()),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!0})),app.use(cors()),app.use(express.static(path.join(__dirname,"webapp"))),"production"===process.env.NODE_ENV){const e=path.join(__dirname,"logs");fs.existsSync(e)||fs.mkdirSync(e);const r=fileStreamRotator.getStream({date_format:"YYYY-MM-DD",filename:path.join(e,"access-%DATE%.log"),frequency:"daily",verbose:!1});app.use(morgan("combined",{stream:r}))}else app.use(morgan("combined"));app.get("/",(e,r)=>{r.status(200).send("May the force be with you.")});const exampleRouter=require(path.join(__dirname,"bundles","example","exampleRouter.js"));app.use("/example",exampleRouter);const srv=app.listen(8080,()=>{logger.info("Server run on port",8080,"in",process.env.NODE_ENV,"mode")});module.exports=srv;